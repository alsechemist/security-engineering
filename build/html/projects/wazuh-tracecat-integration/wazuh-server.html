<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wazuh Server &mdash; Security Engineering 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=86f27845" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=8f9e6779" />

  
  
        <script src="../../_static/jquery.js?v=8dae8fb0"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/clipboard.min.js?v=66b4909c"></script>
        <script src="../../_static/copybutton.js?v=b2447559"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Wazuh Agent: macOS" href="wazuh-agent-macos.html" />
    <link rel="prev" title="Configurations of Servers" href="configuration-of-servers.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Security Engineering
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../main/security-engineering.html">Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../projects.html">Projects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Projects</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="introduction.html">Wazuh &amp; Tracecat Integration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="what-is-wazuh.html">What is Wazuh?</a></li>
<li class="toctree-l2"><a class="reference internal" href="what-is-tracecat.html">What is Tracecat?</a></li>
<li class="toctree-l2"><a class="reference internal" href="the-power-of-integration.html">The Power of Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="what-we-will-learn.html">What We’ll Learn?</a></li>
<li class="toctree-l2"><a class="reference internal" href="scope-of-engagement.html">Scope of Engagement</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="configuration-of-servers.html">Configurations of Servers</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Wazuh Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="wazuh-agent-macos.html">Wazuh Agent: macOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="overview-tracecat-server.html">Overview: Tracecat Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="prerequisite.html">Prerequisite</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Security Engineering</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="introduction.html">Introduction</a></li>
          <li class="breadcrumb-item"><a href="configuration-of-servers.html">Configurations of Servers</a></li>
      <li class="breadcrumb-item active">Wazuh Server</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/projects/wazuh-tracecat-integration/wazuh-server.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="wazuh-server">
<h1>Wazuh Server<a class="headerlink" href="#wazuh-server" title="Link to this heading"></a></h1>
<p><strong>Wazuh Indexer API:</strong> At first lets start with configuring Wazuh Indexer API. You will find the configuration file at <code class="docutils literal notranslate"><span class="pre">/etc/wazuh-indexer/opensearch.yml</span></code> of your Wazuh Server.
It’s a very simple configuration, we only need to change one parameter. By default, the <code class="docutils literal notranslate"><span class="pre">network.host</span></code> parameter is set to <strong>127.0.0.1</strong>,
which means the API is only accessible within the <code class="docutils literal notranslate"><span class="pre">localhost</span></code> itself. Tracecat won’t be able to access the API if it’s <code class="docutils literal notranslate"><span class="pre">localhost</span></code> only,
for that it is recommended to set the parameter to,</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">network.host</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0.0.0.0&quot;</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you want, you can set the parameter to your desired IP address, but you might face some issues while logging in, which you probably have to deal it in your own way.
That’s why it is recommended to set the parameter to be able to be accessible from every network interface of local machine.
If you have more than 2 network interfaces, have it your way of configuring it through about how you would like to give access.</p>
</div>
<p><strong>Wazuh Active Response:</strong> Now lets configure Wazuh’s Active Response at your Wazuh Server. To get started it’s already available on <a class="reference external" href="https://documentation.wazuh.com/current/user-manual/capabilities/active-response/ar-use-cases/blocking-ssh-brute-force.html">Wazuh’s Offical Documentation</a> site.
Wazuh has already pretty much configured their active response for their Linux and Windows endpoint.
An extensive documentation and community support can be found as well.
But here we are going to focus more on <strong>macOS</strong> endpoints as a bit of configuration is need in order for the active response to work properly.</p>
<p><strong>Configuring Active Response for macOS Devices at Wazuh Manager:</strong> Go to your Wazuh Server, you can make changes at your manager node both via Wazuh Web GUI and
by finding the configuration file at <code class="docutils literal notranslate"><span class="pre">/var/ossec/etc/ossec.conf</span></code>, make sure you have <code class="docutils literal notranslate"><span class="pre">sudo</span></code> privileges before accessing through terminal.
But it more recommended that you access via the Web GUI as it’s more easily manageable and accessible. Follow <code class="docutils literal notranslate"><span class="pre">Server</span> <span class="pre">management</span> <span class="pre">→</span> <span class="pre">Settings</span> <span class="pre">→</span> <span class="pre">Edit</span> <span class="pre">configuration</span></code>.
There you have to look out for something like <code class="docutils literal notranslate"><span class="pre">&lt;!--</span> <span class="pre">Active</span> <span class="pre">response</span> <span class="pre">--&gt;</span></code>, in that specific section you will notice various active response scripts as shown in the below image:</p>
<img alt="Wazuh Server Configuration File Active Response Settings" class="align-center" src="../../_images/wazuh-server-img-1.png" />
<div style="height:25px;"></div><p>Since Wazuh leverages their active response scripts based on their respective OS, for example, <code class="docutils literal notranslate"><span class="pre">firewall-drop</span></code> for Linux endpoints, <code class="docutils literal notranslate"><span class="pre">netsh</span></code> for
windows endpoints. Similarly, for macOS endpoints, there is a specific script called <code class="docutils literal notranslate"><span class="pre">pf</span></code>, which is a active response script for
channeling <strong>Packet Filter</strong> as default stateful kernel level firewall used in almost every macOS devices.
You can look into more details of <a class="reference external" href="https://documentation.wazuh.com/current/user-manual/capabilities/active-response/default-active-response-scripts.html">Wazuh Active Response Scripts</a>
via clicking on the hyperlink. These are all available at your Linux, Windows and macOS endpoints.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;command&gt;</span>
<span class="w">    </span><span class="nt">&lt;name&gt;</span>pf<span class="nt">&lt;/name&gt;</span>
<span class="w">    </span><span class="nt">&lt;executable&gt;</span>pf<span class="nt">&lt;/executable&gt;</span>
<span class="w">    </span><span class="nt">&lt;timeout_allowed&gt;</span>yes<span class="nt">&lt;/timeout_allowed&gt;</span>
<span class="nt">&lt;/command&gt;</span>
</pre></div>
</div>
<p>Copy and paste the above code block under that section. And this will enable the <code class="docutils literal notranslate"><span class="pre">pf</span></code> active response script.</p>
<p>Moving forward, find <code class="docutils literal notranslate"><span class="pre">&lt;!--</span> <span class="pre">Active</span> <span class="pre">Response</span> <span class="pre">Rules</span> <span class="pre">--&gt;</span></code> just below and paste the below code block.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;active-response&gt;</span>
<span class="w">    </span><span class="nt">&lt;disabled&gt;</span>no<span class="nt">&lt;/disabled&gt;</span>
<span class="w">    </span><span class="nt">&lt;command&gt;</span>pf<span class="nt">&lt;/command&gt;</span>
<span class="w">    </span><span class="nt">&lt;location&gt;</span>local<span class="nt">&lt;/location&gt;</span>
<span class="w">    </span><span class="nt">&lt;timeout&gt;</span>180<span class="nt">&lt;/timeout&gt;</span>
<span class="nt">&lt;/active-response&gt;</span>
</pre></div>
</div>
<p>This will execute the active response script.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure the above code are under <code class="docutils literal notranslate"><span class="pre">&lt;ossec_config&gt;</span> <span class="pre">*</span> <span class="pre">&lt;/ossec_config&gt;</span></code> block. You can also put under a separate <strong>ossec_config</strong> block at
the last of the configuration file for tracing and managing it a bit more conveniently.</p>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="configuration-of-servers.html" class="btn btn-neutral float-left" title="Configurations of Servers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="wazuh-agent-macos.html" class="btn btn-neutral float-right" title="Wazuh Agent: macOS" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Alsechemist.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>